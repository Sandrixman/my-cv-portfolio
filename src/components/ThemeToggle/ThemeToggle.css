:root {
    --s: 0.3;

    /* Вимкнений стан у світлій темі — холодна матова бульбашка */
    --bulb-base: var(--color-gradient-end);
    --bulb-bg: radial-gradient(
        circle at 30% 30%,
        color-mix(in srgb, #dbe0e8 80%, var(--bulb-base)) 0%,
        color-mix(in srgb, #a3a9b2 70%, black) 90%
    );
    --bulb-inner: color-mix(in srgb, #9098a5 60%, black);
    --bulb-glow: color-mix(in srgb, #cfd5de 50%, white);
    --filament: color-mix(in srgb, #b0b7c2 50%, white);
    --track-light: rgba(255, 255, 255, 0.85);
    --track-dark: rgba(0, 0, 0, 0.15);
}

.dark {
    --bulb-bg: var(--color-accent);
    --bulb-inner: color-mix(in srgb, var(--color-accent-hover) 70%, black);
    --bulb-glow: color-mix(in srgb, var(--color-accent) 50%, white);
    --filament: color-mix(in srgb, var(--color-accent) 65%, #aaa);
    --track-light: rgba(255, 255, 255, 0.05);
    --track-dark: rgba(0, 0, 0, 0.7);
}

/* ====== ТРЕК ====== */
.switch {
    position: relative;
    display: inline-block;
    cursor: pointer;
    width: calc(220px * var(--s));
    height: calc(110px * var(--s));
    border-radius: calc(110px * var(--s));
    background: var(--color-bg-muted);
    box-shadow: inset 2px 2px 5px var(--track-dark), inset -2px -2px 5px var(--track-light);
    transition: all 0.6s ease;
}

/* ====== ЛАМПОЧКА ====== */
.switch .bulb {
    position: absolute;
    top: calc(10px * var(--s));
    left: calc(10px * var(--s));
    width: calc(90px * var(--s));
    height: calc(90px * var(--s));
    border-radius: 50%;
    background: var(--bulb-bg);
    transition: all 0.8s ease;
    box-shadow: inset 0 1px 1px rgba(255, 255, 255, 0.6), inset -3px -3px 5px rgba(0, 0, 0, 0.35),
        inset 0 0 8px 5px var(--bulb-inner), 0 5px 10px rgba(0, 0, 0, 0.35),
        0 0 8px 6px color-mix(in srgb, var(--bulb-glow) 20%, transparent);
}

/* ====== ВНУТРІШНІ ЕЛЕМЕНТИ ====== */
.switch .bulb .bulb-center {
    position: absolute;
    top: 50%;
    left: 50%;
    width: calc(36px * var(--s));
    height: calc(36px * var(--s));
    border-radius: 50%;
    transform: translate(-50%, -50%);
    background: radial-gradient(
        circle at 40% 40%,
        color-mix(in srgb, var(--bulb-glow) 65%, white) 0%,
        var(--bulb-inner) 90%
    );
    box-shadow: inset 0 0 2px rgba(255, 255, 255, 0.4),
        0 0 6px 3px color-mix(in srgb, var(--bulb-glow) 25%, transparent);
    transition: background 0.7s ease, box-shadow 0.9s ease;
}
.switch .bulb .bulb-center:after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: calc(14px * var(--s));
    height: calc(14px * var(--s));
    transform: translate(-50%, -50%);
    border-radius: 50%;
    background: radial-gradient(circle, var(--bulb-glow) 10%, transparent 70%);
    box-shadow: 0 0 4px 2px color-mix(in srgb, var(--bulb-glow) 35%, transparent);
    transition: background 0.7s ease, box-shadow 0.9s ease;
}

/* ====== БЛІКИ ====== */
.reflections {
    position: absolute;
    inset: 0;
    border-radius: 50%;
    overflow: hidden;
    z-index: 90;
    perspective: 70px;
}
.reflections span {
    position: absolute;
    left: calc(-40px * var(--s));
    bottom: calc(-45px * var(--s));
    width: calc(80px * var(--s));
    height: calc(80px * var(--s));
    border-radius: 50%;
    background-image: linear-gradient(-135deg, transparent 10%, rgba(255, 255, 255, 0.25));
}
.reflections span:after {
    content: "";
    position: absolute;
    top: calc(-36px * var(--s));
    right: calc(-40px * var(--s));
    width: calc(20px * var(--s));
    height: calc(35px * var(--s));
    border-radius: 50%;
    box-shadow: 4px -2px 0 -3px rgba(255, 255, 255, 0.3);
    filter: blur(0.8px);
    transform: rotate(-10deg);
}

/* ====== ІСКРИ ====== */
.sparks .spark1,
.sparks .spark2,
.sparks .spark3,
.sparks .spark4 {
    position: absolute;
    border-radius: 50%;
    background: #ffd93b;
    opacity: 0;
    transition: 0.4s;
}
.spark1 {
    right: calc(-5px * var(--s));
    bottom: calc(23px * var(--s));
    width: 1px;
    height: 1px;
}
.spark2 {
    right: calc(20px * var(--s));
    bottom: calc(80px * var(--s));
    width: 2px;
    height: 2px;
}
.spark3 {
    left: calc(20px * var(--s));
    bottom: calc(80px * var(--s));
    width: 2px;
    height: 2px;
}
.spark4 {
    left: calc(20px * var(--s));
    bottom: calc(20px * var(--s));
    width: 2px;
    height: 2px;
}

/* ====== АКТИВНИЙ СТАН (увімкнена лампочка) ====== */
.switch.checked .bulb {
    left: calc(120px * var(--s));
    background: #a7694a;
    box-shadow: inset 0 0 1px 3px #a56758, inset 0 0 6px 8px #6b454f,
        0 10px 20px -10px rgba(0, 0, 0, 0.4), 0 0 25px 30px rgba(253, 184, 67, 0.08);
    transition-delay: 0s;
}
.switch.checked .bulb > .bulb-center {
    background: #feed6b;
    box-shadow: inset 0 0 0 2px #fdec6a, 0 0 10px 6px #bca83c, 0 0 15px 10px #a1664a;
    transition-delay: 0.15s;
}
.switch.checked .bulb > .bulb-center:after {
    background: #fff94f;
    box-shadow: 0 0 3px 4px #fdb843;
    transition-delay: 0.3s;
}
.switch.checked .bulb > .filament-1:before,
.switch.checked .bulb > .filament-2:before,
.switch.checked .bulb > .filament-1:after,
.switch.checked .bulb > .filament-2:after {
    border-color: #fff8c7;
}

/* ====== ІСКРИ (АНІМАЦІЇ) ====== */
.switch.checked .bulb > .sparks .spark1 {
    animation: spark1 2s ease-in-out 0.4s;
}
.switch.checked .bulb > .sparks .spark2 {
    animation: spark2 2.4s ease-in-out 0.4s;
}
.switch.checked .bulb > .sparks .spark3 {
    animation: spark3 2s ease-in-out 0.9s;
}
.switch.checked .bulb > .sparks .spark4 {
    animation: spark4 1.7s ease-in-out 0.9s;
}

/* ====== KEYFRAMES ====== */
@keyframes spark1 {
    0% {
        right: -5px;
        opacity: 0;
    }
    20% {
        right: 0;
        opacity: 1;
    }
    100% {
        right: -60px;
        bottom: 40px;
        opacity: 0;
    }
}
@keyframes spark2 {
    0% {
        opacity: 0;
    }
    30% {
        opacity: 1;
    }
    100% {
        right: -20px;
        bottom: 100px;
        opacity: 0;
    }
}
@keyframes spark3 {
    0% {
        opacity: 0;
    }
    30% {
        opacity: 1;
    }
    100% {
        left: 0;
        bottom: 100px;
        opacity: 0;
    }
}
@keyframes spark4 {
    0% {
        opacity: 0;
    }
    30% {
        opacity: 1;
    }
    100% {
        left: -20px;
        bottom: -10px;
        opacity: 0;
    }
}
